
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Notification Service - Architecture Documentation</title>
	<link rel="stylesheet" href="../styles/style.css">
</head>
<body>
	<div class="container">
		<aside class="sidebar">
			<div class="sidebar-header">
				<h1><a href="../index.html">Notification Service</a></h1>
			</div>
			<nav class="sidebar-nav">
				<div class="search-box">
					<input type="text" id="search" placeholder="Search..." class="search-input">
				</div>
				<ul class="system-list">
					<li class="active">
						<a href="#" class="system-link">Notification Service</a>
						
						<ul class="container-list">
							
							<li><a href="#delivery-channels" class="container-link">Delivery Channels</a></li>
							
							<li><a href="#event-bus" class="container-link">Event Bus</a></li>
							
							<li><a href="#message-queue" class="container-link">Message Queue</a></li>
							
							<li><a href="#processing-layer" class="container-link">Processing Layer</a></li>
							
							<li><a href="#api-gateway" class="container-link">API Gateway</a></li>
							
							<li><a href="#data-store" class="container-link">Data Store</a></li>
							
						</ul>
						
					</li>
				</ul>
			</nav>
		</aside>
		<main class="main-content">
			<div class="breadcrumb">
				<a href="../index.html" class="breadcrumb-item">Home</a>
				<span class="breadcrumb-separator">/</span>
				<span class="breadcrumb-item active">Notification Service</span>
			</div>
			<article class="content">
				<h1>Notification Service</h1>
				
				<p class="description">Serverless notification system for sending email and SMS alerts with full delivery tracking, retry logic, and notification history on AWS</p>
				

				

			
			<section class="diagram-section">
				<h2>System Diagram</h2>
				<div class="diagram-container">
					
					<img src="../diagrams/notification-service.svg" alt="Notification Service Diagram" class="diagram-image">
					
				</div>
			</section>
			

			
			<section class="markdown-section">
				<h2>Documentation</h2>
				<div class="markdown-content">
					

<h1>Notification Service</h1>

<p>Serverless notification system for sending email and SMS alerts with full delivery tracking, retry logic, and notification history on AWS</p>

<h2>Context</h2>

<p>This is a <strong>C4 Level 1 - System Context Diagram</strong> showing this system in the broader architecture.</p>

<h2>Key Users</h2>

<p>The following actors interact with this system:</p>

<ul>
<li><strong>Internal Services</strong></li>
<li><strong>Operations Team</strong></li>
<li><strong>End Users</strong></li>
</ul>

<h2>System Responsibilities</h2>

<p>This system is responsible for:</p>

<ul>
<li>Accept notification requests via REST API and events</li>
<li>Route notifications to email and SMS channels</li>
<li>Send emails via Amazon SES</li>
<li>Send SMS via Amazon SNS</li>
<li>Track delivery status with DynamoDB</li>
<li>Retry failed notifications with exponential backoff</li>
<li>Provide notification status and history queries</li>
</ul>

<h2>Internal Dependencies</h2>

<p>This system depends on the following internal systems or services:</p>

<ul>
<li>Amazon SES</li>
<li>Amazon SNS</li>
<li>Amazon SQS</li>
<li>Amazon DynamoDB</li>
<li>Amazon EventBridge</li>
<li>Amazon API Gateway</li>
</ul>

<h2>External System Integrations</h2>

<p>This system integrates with:</p>

<ul>
<li>Amazon SES</li>
<li>Amazon SNS</li>
</ul>

<h2>Containers</h2>

<p>The system is composed of the following containers:</p>

<table>
<thead>
<tr>
<th>Container</th>
<th>Description</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>(Add your containers here)</td>
</tr>
</tbody>
</table>

<h2>Technology Stack</h2>

<ul>
<li><strong>Primary Language</strong>: Go</li>
<li><strong>Framework/Library</strong>: AWS Lambda + SAM</li>
<li><strong>Database</strong>: (To be determined)</li>
</ul>



				</div>
			</section>
			

				
				<section class="containers-section">
					<h2>Containers</h2>
					<div class="containers-list">
						
						<div class="container-item" id="delivery-channels">
							<h3>Delivery Channels</h3>
							
							<p>External AWS services for actual email and SMS delivery</p>
							
							
							
						
						<div class="diagram-container">
							
							<img src="../diagrams/notification-service_delivery-channels.svg" alt="Delivery Channels Diagram" class="diagram-image">
							
						</div>
						
							
							<div class="components-list">
								<h4>Components</h4>
								<ul>
									
									<li>
										<a href="../components/ses-email-service.html" class="component-link"><strong>SES Email Service</strong></a>
										<p>Amazon Simple Email Service for transactional email delivery with bounce and complaint feedback</p>
									</li>
									
									<li>
										<a href="../components/sns-sms-service.html" class="component-link"><strong>SNS SMS Service</strong></a>
										<p>Amazon Simple Notification Service for SMS delivery to phone numbers</p>
									</li>
									
								</ul>
							</div>
							
						</div>
						
						<div class="container-item" id="event-bus">
							<h3>Event Bus</h3>
							
							<p>Custom EventBridge bus for event-driven notification triggers from other services</p>
							
							
							
						
						<div class="diagram-container">
							
							<img src="../diagrams/notification-service_event-bus.svg" alt="Event Bus Diagram" class="diagram-image">
							
						</div>
						
							
							<div class="components-list">
								<h4>Components</h4>
								<ul>
									
									<li>
										<a href="../components/event-patterns.html" class="component-link"><strong>Event Patterns</strong></a>
										<p>Configurable event patterns for matching events like OrderCompleted, CriticalAlert, UserSignup</p>
									</li>
									
									<li>
										<a href="../components/event-rules.html" class="component-link"><strong>Event Rules</strong></a>
										<p>EventBridge rules that match notification-triggering events and route them to the Notification Router Lambda</p>
									</li>
									
								</ul>
							</div>
							
						</div>
						
						<div class="container-item" id="message-queue">
							<h3>Message Queue</h3>
							
							<p>SQS queues for decoupling notification processing with dead-letter queue for failed messages</p>
							
							
							
						
						<div class="diagram-container">
							
							<img src="../diagrams/notification-service_message-queue.svg" alt="Message Queue Diagram" class="diagram-image">
							
						</div>
						
							
							<div class="components-list">
								<h4>Components</h4>
								<ul>
									
									<li>
										<a href="../components/dead-letter-queue.html" class="component-link"><strong>Dead Letter Queue</strong></a>
										<p>Shared DLQ for failed email and SMS messages. 14-day retention, CloudWatch alarm on depth > 0</p>
									</li>
									
									<li>
										<a href="../components/email-queue.html" class="component-link"><strong>Email Queue</strong></a>
										<p>Standard SQS queue for email notifications. 120s visibility timeout, 4-day retention, max 3 receives before DLQ</p>
									</li>
									
									<li>
										<a href="../components/sms-queue.html" class="component-link"><strong>SMS Queue</strong></a>
										<p>Standard SQS queue for SMS notifications. 120s visibility timeout, 4-day retention, max 3 receives before DLQ</p>
									</li>
									
								</ul>
							</div>
							
						</div>
						
						<div class="container-item" id="processing-layer">
							<h3>Processing Layer</h3>
							
							<p>Lambda functions for notification routing, sending, status tracking, and retry handling</p>
							
							
							
						
						<div class="diagram-container">
							
							<img src="../diagrams/notification-service_processing-layer.svg" alt="Processing Layer Diagram" class="diagram-image">
							
						</div>
						
							
							<div class="components-list">
								<h4>Components</h4>
								<ul>
									
									<li>
										<a href="../components/email-sender.html" class="component-link"><strong>Email Sender</strong></a>
										<p>Consumes from email SQS queue, formats email content, sends via SES SendEmail API, updates delivery status in DynamoDB</p>
									</li>
									
									<li>
										<a href="../components/notification-router.html" class="component-link"><strong>Notification Router</strong></a>
										<p>Validates requests, generates UUIDv7 ID, performs idempotency check, writes PENDING to DynamoDB, enqueues to appropriate SQS queue(s)</p>
									</li>
									
									<li>
										<a href="../components/retry-handler.html" class="component-link"><strong>Retry Handler</strong></a>
										<p>Consumes from DLQ, implements exponential backoff (60s/240s/960s), re-enqueues or marks PERMANENTLY_FAILED after 3 retries</p>
									</li>
									
									<li>
										<a href="../components/sms-sender.html" class="component-link"><strong>SMS Sender</strong></a>
										<p>Consumes from SMS SQS queue, formats message, sends via SNS Publish API, updates delivery status in DynamoDB</p>
									</li>
									
									<li>
										<a href="../components/status-tracker.html" class="component-link"><strong>Status Tracker</strong></a>
										<p>Processes SES/SNS delivery callbacks (delivered, bounced, complained), updates delivery status in DynamoDB, publishes status change events</p>
									</li>
									
								</ul>
							</div>
							
						</div>
						
						<div class="container-item" id="api-gateway">
							<h3>API Gateway</h3>
							
							<p>REST API entry point for sending notifications and querying delivery status</p>
							
							
							
						
						<div class="diagram-container">
							
							<img src="../diagrams/notification-service_api-gateway.svg" alt="API Gateway Diagram" class="diagram-image">
							
						</div>
						
							
							<div class="components-list">
								<h4>Components</h4>
								<ul>
									
									<li>
										<a href="../components/get-status-endpoint.html" class="component-link"><strong>Get Status Endpoint</strong></a>
										<p>GET /notifications/{id} - Returns notification details and delivery status history</p>
									</li>
									
									<li>
										<a href="../components/list-notifications-endpoint.html" class="component-link"><strong>List Notifications Endpoint</strong></a>
										<p>GET /notifications - Lists notifications with filters by recipient, status, and date range with pagination</p>
									</li>
									
									<li>
										<a href="../components/send-notification-endpoint.html" class="component-link"><strong>Send Notification Endpoint</strong></a>
										<p>POST /notifications - Accepts notification requests with JSON Schema validation, returns 202 Accepted with notification ID</p>
									</li>
									
								</ul>
							</div>
							
						</div>
						
						<div class="container-item" id="data-store">
							<h3>Data Store</h3>
							
							<p>DynamoDB tables for notification history, delivery status tracking, and idempotency</p>
							
							
							
						
						<div class="diagram-container">
							
							<img src="../diagrams/notification-service_data-store.svg" alt="Data Store Diagram" class="diagram-image">
							
						</div>
						
							
							<div class="components-list">
								<h4>Components</h4>
								<ul>
									
									<li>
										<a href="../components/delivery-status-table.html" class="component-link"><strong>Delivery Status Table</strong></a>
										<p>PK: NOTIF#{id}, SK: STATUS#{channel}#{attempt}. GSI: ProviderIndex (providerMessageId). On-demand capacity, 90-day TTL</p>
									</li>
									
									<li>
										<a href="../components/notifications-table.html" class="component-link"><strong>Notifications Table</strong></a>
										<p>PK: NOTIF#{id}, SK: METADATA. GSIs: RecipientIndex, StatusIndex, IdempotencyIndex. On-demand capacity, 90-day TTL</p>
									</li>
									
								</ul>
							</div>
							
						</div>
						
					</div>
				</section>
				
			</article>
			<footer class="footer">
				<p>Generated by <a href="https://github.com/madstone-tech/loko">loko</a></p>
			</footer>
		</main>
	</div>
	<script src="../js/main.js"></script>
</body>
</html>
